<template name="Marketplace_history">
    <div class="ibox ecommerce">
        {{#let partner=this }}
        <div class="product-desc">
            {{> Partner_rating partner }}
        </div>
        <div class="table-responsive">
            <table class="table table-striped">
                <tbody>
                <!--tr style="font-weight: bold">
                    <td>{{_ 'schemaTransactions.valueDate.label'}}</td>
                    <td>{{_ 'schemaListings.title.label'}}</td>
                    <td>{{_ 'Partner'}}</td>
                    <td>{{_ 'Review'}}</td>
                    <td class="text-right">{{_ 'schemaDeals.price.label'}}</td>
                </tr-->
                {{#each deal in partner.marketHistory.deals}}
                <tr>
                {{#let effectiveAmount=(deal.amountOf partner) }}
                    <td class="text-capitalize">{{deal.listing.title}}</td>
                    {{#let otherPartner=(deal.otherPartner partner.user)}}
                    <td class="text-right">
                        <img class="m-l-sm m-r-sm" alt="avatar" src={{absoluteUrl partner.avatar}} width="24">
                        <button class="btn btn-xs btn-{{color effectiveAmount}}"><i class="fa fa-large fa-{{directionIcon effectiveAmount}}"></i></button>
                        <img class="m-l-sm m-r-sm" alt="avatar" src={{absoluteUrl otherPartner.avatar}} width="24">  
                    </td>
                    <td class="text-capitalize">{{otherPartner}}</td>
                    {{/let}}
                    {{#let review=(deal.otherPartnerReview partner.user) }}
                    <td>{{#if review}}{{review.rating}} <i class="fa fa-star active"></i> {{>Action_buttons_group collection='reviews' doc=review actions='view' size='sm'}}{{/if}}</td>
                    {{/let}}
                    <td class="text-right"><i class="fa fa-clock-o"></i> {{displayTimeFrom deal.updatedAt}}</td>
                    <td class="text-right">
                        <i class="fa fa-large btn-{{color effectiveAmount}} {{icon effectiveAmount}}"></i> {{displayCurrency (abs effectiveAmount)}}
                    </td>
                {{/let}}
                </tr>
                {{/each}}
                </tbody>
            </table>
        </div>
        {{/let}}
    </div>
</template>
