<template name="Community_page">
  <div class="content-scrollable page-content page-housing">
    
    <div style="width:100%;" class="white-box padded">
      {{#if community}}
      <div id="tab-content1" class="content">
        <button type="button" class="primary" name="button"></button>
        <div class="row community-section">
          <div class="col-xs-12 col-lg-4 pull-right">
            <div id="house_avatar">
              <a href="{{community/avatar}}" class="simple-lightbox"><img src="{{community/avatar}}" alt="community avatar" width="100%" /></a>
            </div>
            <div>
            {{#autoForm id="af.community.view" collection=communities omitFields="name,description,avatar" doc=community type="readonly" template="bootstrap3"}}
              {{#if userHasPermission 'communities.update' community/_id}}
              <div class="row">
                <button class="btn btn-primary js-edit">{{_ "edit"}}</button>
              </div>
              {{/if}}
              {{> afQuickFields}}
              {{/autoForm}}
            </div>
          </div>
          <div class="col-xs-12 col-lg-8">
            <h1 id="houseName" class="text-center">{{community/name}} {{_ "data"}}</h1>
            <!--div class="form-group">
              <label for="houseName">Leírás</label>
              <textarea class="form-control vert" id="houseWelcome" placeholder="Welcome" rows="12"></textarea>
            </div-->
            <div class="roles-section">
              <div class="row">
                <div class="col-xs-12 text-center">
                  <h4 class="page-title">{{_ 'roles'}}</h4>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 table-responsive">
                  {{> ReactiveDatatable tableData=rolesTableDataFn options=rolesOptionsFn }}
                </div>
              </div>
              {{#if userHasPermission 'roleships.create' community/_id}}
                <div class="row">
                  <div class="col-xs-12 text-center">
                    <button class="js-new btn btn-primary">{{_ 'createNew'}}</button>
                  </div>
                </div>
              {{/if}}
            </div>
          </div>
          <!--ul class="list-group no-style">
            {{#each countInfo in thingsToDisplayWithCounter}}
              <li><img src="/icon/si-glyph-mail-box.svg" width="20"/>{{_ countInfo/name}}: {{countInfo/count}}</li>
            {{/each}}
          </ul-->
        </div>
        {{#if userHasPermission 'parcels.inCommunity' community/_id}}
        <div class="parcels-section">
          <div class="row">
            <div class="col-xs-12">
              <hr>
              <h4>{{_ "Parcels of community"}}</h4>
              <br>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12">
              {{#Collapse_section id='parcel' title='parcels' collapsed=true}}
                <!-- Approved section -->
                <div class="table-responsive">
                {{> ReactiveDatatable tableData=parcelsTableDataFn options=parcelsOptionsFn }}
                </div>
                {{#if userHasPermission 'parcels.insert' community/_id}}
                  <button class="js-new btn btn-primary">{{_ 'createNew'}}</button>
                {{/if}}
                <!-- UnApproved section -->
                {{#if hasUnapprovedParcels}}
                <h4 align="center">{{_ "Waiting for approval"}}</h4>
                <div class="table-responsive">
                {{> ReactiveDatatable tableData=unapprovedParcelsTableDataFn options=parcelsOptionsFn }}
                </div>
                {{/if}}
              {{/Collapse_section}}
            </div>
          </div>
        </div>
        {{/if}}
      </div>
      {{else}}
        {{_ "No active community"}}
      {{/if}}
    </div>
  </div>
  
  {{sortables}}
</template>
